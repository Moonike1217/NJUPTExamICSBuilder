<view class="container">
  <!-- 学号信息 -->
  <view class="card">
    <view class="class-info">
      <text class="info-label">当前学号：</text>
      <text class="info-value">{{classId}}</text>
      <button class="btn-secondary btn-small" bindtap="changeClassId">修改</button>
    </view>
  </view>

  <!-- 上传区域 -->
  <view class="card">
    <text class="section-title">上传考试文件</text>
    <text class="text-muted mb-20">请上传教务处发布的Excel考试安排文件</text>
    
    <view class="upload-area" bindtap="chooseFile">
      <view class="upload-content">
        <text class="upload-icon">📁</text>
        <text class="upload-text">点击选择Excel文件</text>
        <text class="upload-hint">支持 .xlsx 和 .xls 格式</text>
      </view>
    </view>
    
    <!-- 文件信息 -->
    <view class="file-info" wx:if="{{selectedFile}}">
      <view class="file-item">
        <text class="file-icon">📄</text>
        <view class="file-details">
          <text class="file-name">{{selectedFile.name}}</text>
          <text class="file-size">{{fileSize}}</text>
        </view>
        <text class="file-status">{{fileStatus}}</text>
      </view>
    </view>
  </view>

  <!-- 或者输入考试数据 -->
  <view class="card">
    <text class="section-title">或者手动输入考试信息</text>
    <text class="text-muted mb-20">如果没有Excel文件，可以手动输入考试信息</text>
    
    <button class="btn-secondary" bindtap="manualInput">手动输入</button>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button 
      class="btn-primary" 
      bindtap="uploadAndSearch"
      disabled="{{!selectedFile || uploading}}"
      loading="{{uploading}}"
    >
      {{uploading ? '上传中...' : '上传并查询考试'}}
    </button>
  </view>

  <!-- 上传进度 -->
  <view class="upload-progress" wx:if="{{uploading}}">
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{uploadProgress}}%"></view>
    </view>
    <text class="progress-text">上传进度：{{uploadProgress}}%</text>
  </view>

  <!-- 错误信息 -->
  <view class="error-message" wx:if="{{errorMessage}}">
    {{errorMessage}}
  </view>

  <!-- 使用说明 -->
  <view class="card">
    <text class="section-title">文件要求</text>
    <view class="requirements">
      <view class="requirement-item">
        <text class="requirement-icon">✓</text>
        <text class="requirement-text">文件格式：Excel (.xlsx, .xls)</text>
      </view>
      <view class="requirement-item">
        <text class="requirement-icon">✓</text>
        <text class="requirement-text">文件大小：不超过10MB</text>
      </view>
      <view class="requirement-item">
        <text class="requirement-icon">✓</text>
        <text class="requirement-text">内容：包含学号、课程名称、考试时间等信息</text>
      </view>
    </view>
  </view>
</view> 